app-id: com.kraftsman.avva
runtime: org.gnome.Platform
runtime-version: '45'
sdk: org.gnome.Sdk
command: avva
finish-args:
  # Networking for API/LLM calls and WebSocket bridge
  - --share=network
  - --share=ipc
  # Display
  - --socket=x11
  - --socket=wayland
  # Audio (Microphone for STT, Speakers for TTS)
  - --socket=pulseaudio
  - --device=all
  # Local Filesystem for Brains / Knowledge Base
  - --filesystem=home

modules:
  - name: avva
    buildsystem: simple
    build-commands:
      - install -D avva /app/bin/avva
      - install -D avva-core-x86_64-unknown-linux-gnu /app/bin/avva-core-x86_64-unknown-linux-gnu
      - mkdir -p /app/bin/bin
      - cp -r bin/* /app/bin/bin/
    sources:
      - type: file
        path: ui-web/src-tauri/target/release/avva
      - type: file
        path: ui-web/src-tauri/sidecars/avva-core-x86_64-unknown-linux-gnu
      - type: dir
        path: bin
